{
  "summary": {
    "total_programs": 6,
    "total_rules": 35,
    "rule_types": {
      "workflow": 32,
      "data_access": 3
    },
    "priority_distribution": {
      "4": 33,
      "3": 2
    },
    "files_analyzed": [
      "examples\\example.clle",
      "examples\\otmc10.clle",
      "examples\\example.rpgle",
      "examples\\example_rpg_fixed.rpg",
      "examples\\schema.sql",
      "examples\\display.dspf"
    ]
  },
  "programs": {
    "examples\\example.clle": {
      "metrics": {
        "total_rules": 11,
        "validation_rules": 0,
        "calculation_rules": 0,
        "workflow_rules": 11,
        "error_handling_rules": 0,
        "data_access_rules": 0,
        "integration_rules": 0,
        "security_rules": 0
      },
      "rules": [
        {
          "rule_id": "RULE_0001",
          "rule_type": "workflow",
          "priority": 4,
          "description": "Execute PGM: ",
          "condition": "",
          "action": "",
          "source_file": "examples\\example.clle",
          "line_number": 1,
          "variables": [],
          "files_accessed": [],
          "related_rules": [],
          "business_context": ""
        },
        {
          "rule_id": "RULE_0002",
          "rule_type": "workflow",
          "priority": 4,
          "description": "Execute R(&MSG): (TYPE(*CHAR)) (LEN(50))",
          "condition": "",
          "action": "(TYPE(*CHAR)) (LEN(50))",
          "source_file": "examples\\example.clle",
          "line_number": 2,
          "variables": [],
          "files_accessed": [],
          "related_rules": [],
          "business_context": ""
        },
        {
          "rule_id": "RULE_0003",
          "rule_type": "workflow",
          "priority": 4,
          "description": "Execute R(&RC): (TYPE(*DEC)) (LEN(5) (0))",
          "condition": "",
          "action": "(TYPE(*DEC)) (LEN(5) (0))",
          "source_file": "examples\\example.clle",
          "line_number": 3,
          "variables": [],
          "files_accessed": [],
          "related_rules": [],
          "business_context": ""
        },
        {
          "rule_id": "RULE_0004",
          "rule_type": "workflow",
          "priority": 4,
          "description": "Execute MSG: (MSG('Starting CL program'))",
          "condition": "",
          "action": "(MSG('Starting CL program'))",
          "source_file": "examples\\example.clle",
          "line_number": 4,
          "variables": [],
          "files_accessed": [],
          "related_rules": [],
          "business_context": ""
        },
        {
          "rule_id": "RULE_0005",
          "rule_type": "workflow",
          "priority": 4,
          "description": "Execute GM(MYPGM): (PARM(&MSG) (&RC))",
          "condition": "",
          "action": "(PARM(&MSG) (&RC))",
          "source_file": "examples\\example.clle",
          "line_number": 5,
          "variables": [
            "&RC)"
          ],
          "files_accessed": [],
          "related_rules": [],
          "business_context": ""
        },
        {
          "rule_id": "RULE_0006",
          "rule_type": "workflow",
          "priority": 4,
          "description": "Execute D(&RC: (*GT) (0)) (THEN(DO))",
          "condition": "",
          "action": "(*GT) (0)) (THEN(DO))",
          "source_file": "examples\\example.clle",
          "line_number": 6,
          "variables": [],
          "files_accessed": [],
          "related_rules": [],
          "business_context": ""
        },
        {
          "rule_id": "RULE_0007",
          "rule_type": "workflow",
          "priority": 4,
          "description": "Execute PGMMSG: (MSG('Error occurred')) (MSGTYPE(*DIAG))",
          "condition": "",
          "action": "(MSG('Error occurred')) (MSGTYPE(*DIAG))",
          "source_file": "examples\\example.clle",
          "line_number": 7,
          "variables": [],
          "files_accessed": [],
          "related_rules": [],
          "business_context": ""
        },
        {
          "rule_id": "RULE_0008",
          "rule_type": "workflow",
          "priority": 4,
          "description": "Execute O: (CMDLBL(ENDIT))",
          "condition": "",
          "action": "(CMDLBL(ENDIT))",
          "source_file": "examples\\example.clle",
          "line_number": 8,
          "variables": [],
          "files_accessed": [],
          "related_rules": [],
          "business_context": ""
        },
        {
          "rule_id": "RULE_0009",
          "rule_type": "workflow",
          "priority": 4,
          "description": "Execute ENDDO: ",
          "condition": "",
          "action": "",
          "source_file": "examples\\example.clle",
          "line_number": 9,
          "variables": [],
          "files_accessed": [],
          "related_rules": [],
          "business_context": ""
        },
        {
          "rule_id": "RULE_0010",
          "rule_type": "workflow",
          "priority": 4,
          "description": "Execute ENDIT:: (RETURN)",
          "condition": "",
          "action": "(RETURN)",
          "source_file": "examples\\example.clle",
          "line_number": 10,
          "variables": [],
          "files_accessed": [],
          "related_rules": [],
          "business_context": ""
        },
        {
          "rule_id": "RULE_0011",
          "rule_type": "workflow",
          "priority": 4,
          "description": "Execute ENDPGM: ",
          "condition": "",
          "action": "",
          "source_file": "examples\\example.clle",
          "line_number": 11,
          "variables": [],
          "files_accessed": [],
          "related_rules": [],
          "business_context": ""
        }
      ]
    },
    "examples\\otmc10.clle": {
      "metrics": {
        "total_rules": 18,
        "validation_rules": 0,
        "calculation_rules": 0,
        "workflow_rules": 18,
        "error_handling_rules": 0,
        "data_access_rules": 0,
        "integration_rules": 0,
        "security_rules": 0
      },
      "rules": [
        {
          "rule_id": "RULE_0012",
          "rule_type": "workflow",
          "priority": 4,
          "description": "Execute M: ",
          "condition": "",
          "action": "",
          "source_file": "examples\\otmc10.clle",
          "line_number": 23,
          "variables": [],
          "files_accessed": [],
          "related_rules": [],
          "business_context": ""
        },
        {
          "rule_id": "RULE_0013",
          "rule_type": "workflow",
          "priority": 4,
          "description": "Execute L: (VAR(&LIBR)) (TYPE(*CHAR)) (LEN(10))",
          "condition": "",
          "action": "(VAR(&LIBR)) (TYPE(*CHAR)) (LEN(10))",
          "source_file": "examples\\otmc10.clle",
          "line_number": 25,
          "variables": [],
          "files_accessed": [],
          "related_rules": [],
          "business_context": ""
        },
        {
          "rule_id": "RULE_0014",
          "rule_type": "workflow",
          "priority": 4,
          "description": "Execute L: (VAR(&TEMPFILE)) (TYPE(*CHAR)) (LEN(10)) (+)",
          "condition": "",
          "action": "(VAR(&TEMPFILE)) (TYPE(*CHAR)) (LEN(10)) (+)",
          "source_file": "examples\\otmc10.clle",
          "line_number": 26,
          "variables": [],
          "files_accessed": [],
          "related_rules": [],
          "business_context": ""
        },
        {
          "rule_id": "RULE_0015",
          "rule_type": "workflow",
          "priority": 4,
          "description": "Execute VALUE('FDIAPTP'): ",
          "condition": "",
          "action": "",
          "source_file": "examples\\otmc10.clle",
          "line_number": 27,
          "variables": [],
          "files_accessed": [],
          "related_rules": [],
          "business_context": ""
        },
        {
          "rule_id": "RULE_0016",
          "rule_type": "workflow",
          "priority": 4,
          "description": "Execute TF: (FILE(QTEMP/FDIAPTP))",
          "condition": "",
          "action": "(FILE(QTEMP/FDIAPTP))",
          "source_file": "examples\\otmc10.clle",
          "line_number": 34,
          "variables": [],
          "files_accessed": [],
          "related_rules": [],
          "business_context": ""
        },
        {
          "rule_id": "RULE_0017",
          "rule_type": "workflow",
          "priority": 4,
          "description": "Execute NMSG: (MSGID(CPF0000))",
          "condition": "",
          "action": "(MSGID(CPF0000))",
          "source_file": "examples\\otmc10.clle",
          "line_number": 35,
          "variables": [],
          "files_accessed": [],
          "related_rules": [],
          "business_context": ""
        },
        {
          "rule_id": "RULE_0018",
          "rule_type": "workflow",
          "priority": 4,
          "description": "Execute VOBJD: (OBJ(&TEMPFILE)) (OBJTYPE(*FILE)) (RTNLIB(&LIBR))",
          "condition": "",
          "action": "(OBJ(&TEMPFILE)) (OBJTYPE(*FILE)) (RTNLIB(&LIBR))",
          "source_file": "examples\\otmc10.clle",
          "line_number": 37,
          "variables": [],
          "files_accessed": [],
          "related_rules": [],
          "business_context": ""
        },
        {
          "rule_id": "RULE_0019",
          "rule_type": "workflow",
          "priority": 4,
          "description": "Execute TDUPOBJ: (OBJ(&TEMPFILE)) (FROMLIB(&LIBR)) (OBJTYPE(*FILE)) (+)",
          "condition": "",
          "action": "(OBJ(&TEMPFILE)) (FROMLIB(&LIBR)) (OBJTYPE(*FILE)) (+)",
          "source_file": "examples\\otmc10.clle",
          "line_number": 40,
          "variables": [],
          "files_accessed": [],
          "related_rules": [],
          "business_context": ""
        },
        {
          "rule_id": "RULE_0020",
          "rule_type": "workflow",
          "priority": 4,
          "description": "Execute TOLIB(QTEMP): (NEWOBJ(&TEMPFILE))",
          "condition": "",
          "action": "(NEWOBJ(&TEMPFILE))",
          "source_file": "examples\\otmc10.clle",
          "line_number": 41,
          "variables": [],
          "files_accessed": [],
          "related_rules": [],
          "business_context": ""
        },
        {
          "rule_id": "RULE_0021",
          "rule_type": "workflow",
          "priority": 4,
          "description": "Execute NMSG: (MSGID(CPF0000))",
          "condition": "",
          "action": "(MSGID(CPF0000))",
          "source_file": "examples\\otmc10.clle",
          "line_number": 42,
          "variables": [],
          "files_accessed": [],
          "related_rules": [],
          "business_context": ""
        },
        {
          "rule_id": "RULE_0022",
          "rule_type": "workflow",
          "priority": 4,
          "description": "Execute RDBF: (FILE(&TEMPFILE)) (TOFILE(QTEMP/&TEMPFILE))",
          "condition": "",
          "action": "(FILE(&TEMPFILE)) (TOFILE(QTEMP/&TEMPFILE))",
          "source_file": "examples\\otmc10.clle",
          "line_number": 46,
          "variables": [],
          "files_accessed": [],
          "related_rules": [],
          "business_context": ""
        },
        {
          "rule_id": "RULE_0023",
          "rule_type": "workflow",
          "priority": 4,
          "description": "Execute LL: (PGM(OTMR1090))",
          "condition": "",
          "action": "(PGM(OTMR1090))",
          "source_file": "examples\\otmc10.clle",
          "line_number": 52,
          "variables": [],
          "files_accessed": [],
          "related_rules": [],
          "business_context": ""
        },
        {
          "rule_id": "RULE_0024",
          "rule_type": "workflow",
          "priority": 4,
          "description": "Execute LRSC: ",
          "condition": "",
          "action": "",
          "source_file": "examples\\otmc10.clle",
          "line_number": 57,
          "variables": [],
          "files_accessed": [],
          "related_rules": [],
          "business_context": ""
        },
        {
          "rule_id": "RULE_0025",
          "rule_type": "workflow",
          "priority": 4,
          "description": "Execute TOVR: (FILE(&TEMPFILE))",
          "condition": "",
          "action": "(FILE(&TEMPFILE))",
          "source_file": "examples\\otmc10.clle",
          "line_number": 58,
          "variables": [],
          "files_accessed": [],
          "related_rules": [],
          "business_context": ""
        },
        {
          "rule_id": "RULE_0026",
          "rule_type": "workflow",
          "priority": 4,
          "description": "Execute NMSG: (MSGID(CPF0000))",
          "condition": "",
          "action": "(MSGID(CPF0000))",
          "source_file": "examples\\otmc10.clle",
          "line_number": 59,
          "variables": [],
          "files_accessed": [],
          "related_rules": [],
          "business_context": ""
        },
        {
          "rule_id": "RULE_0027",
          "rule_type": "workflow",
          "priority": 4,
          "description": "Execute TF: (FILE(QTEMP/&TEMPFILE))",
          "condition": "",
          "action": "(FILE(QTEMP/&TEMPFILE))",
          "source_file": "examples\\otmc10.clle",
          "line_number": 61,
          "variables": [],
          "files_accessed": [],
          "related_rules": [],
          "business_context": ""
        },
        {
          "rule_id": "RULE_0028",
          "rule_type": "workflow",
          "priority": 4,
          "description": "Execute NMSG: (MSGID(CPF0000))",
          "condition": "",
          "action": "(MSGID(CPF0000))",
          "source_file": "examples\\otmc10.clle",
          "line_number": 62,
          "variables": [],
          "files_accessed": [],
          "related_rules": [],
          "business_context": ""
        },
        {
          "rule_id": "RULE_0029",
          "rule_type": "workflow",
          "priority": 4,
          "description": "Execute DPGM: ",
          "condition": "",
          "action": "",
          "source_file": "examples\\otmc10.clle",
          "line_number": 67,
          "variables": [],
          "files_accessed": [],
          "related_rules": [],
          "business_context": ""
        }
      ]
    },
    "examples\\example.rpgle": {
      "metrics": {
        "total_rules": 3,
        "validation_rules": 0,
        "calculation_rules": 0,
        "workflow_rules": 3,
        "error_handling_rules": 0,
        "data_access_rules": 0,
        "integration_rules": 0,
        "security_rules": 0
      },
      "rules": [
        {
          "rule_id": "RULE_0030",
          "rule_type": "workflow",
          "priority": 4,
          "description": "RPG rpgassignstmt: Target: RpgExpr(loc=SourceLocation(file='examples\\\\example.rpgle', line=9, column=0), kind='ident', value='Var1', children=[])",
          "condition": "",
          "action": "Target: RpgExpr(loc=SourceLocation(file='examples\\\\example.rpgle', line=9, column=0), kind='ident', value='Var1', children=[])",
          "source_file": "examples\\example.rpgle",
          "line_number": 9,
          "variables": [
            "RpgExpr(loc=SourceLocation(file='examples\\\\example.rpgle', line=9, column=0), kind='ident', value='Var1', children=[])"
          ],
          "files_accessed": [],
          "related_rules": [],
          "business_context": ""
        },
        {
          "rule_id": "RULE_0031",
          "rule_type": "workflow",
          "priority": 4,
          "description": "RPG rpgassignstmt: Target: RpgExpr(loc=SourceLocation(file='examples\\\\example.rpgle', line=10, column=0), kind='ident', value='Var2', children=[])",
          "condition": "",
          "action": "Target: RpgExpr(loc=SourceLocation(file='examples\\\\example.rpgle', line=10, column=0), kind='ident', value='Var2', children=[])",
          "source_file": "examples\\example.rpgle",
          "line_number": 10,
          "variables": [
            "RpgExpr(loc=SourceLocation(file='examples\\\\example.rpgle', line=10, column=0), kind='ident', value='Var2', children=[])"
          ],
          "files_accessed": [],
          "related_rules": [],
          "business_context": ""
        },
        {
          "rule_id": "RULE_0032",
          "rule_type": "workflow",
          "priority": 4,
          "description": "RPG rpgreturnstmt: ",
          "condition": "",
          "action": "",
          "source_file": "examples\\example.rpgle",
          "line_number": 18,
          "variables": [],
          "files_accessed": [],
          "related_rules": [],
          "business_context": ""
        }
      ]
    },
    "examples\\example_rpg_fixed.rpg": {
      "metrics": {},
      "rules": []
    },
    "examples\\schema.sql": {
      "metrics": {
        "total_rules": 3,
        "validation_rules": 0,
        "calculation_rules": 0,
        "workflow_rules": 0,
        "error_handling_rules": 0,
        "data_access_rules": 3,
        "integration_rules": 0,
        "security_rules": 0
      },
      "rules": [
        {
          "rule_id": "RULE_0033",
          "rule_type": "data_access",
          "priority": 4,
          "description": "SQL db2ddl: ",
          "condition": "",
          "action": "",
          "source_file": "examples\\schema.sql",
          "line_number": 1,
          "variables": [],
          "files_accessed": [],
          "related_rules": [],
          "business_context": ""
        },
        {
          "rule_id": "RULE_0034",
          "rule_type": "data_access",
          "priority": 3,
          "description": "SQL db2select: ",
          "condition": "",
          "action": "",
          "source_file": "examples\\schema.sql",
          "line_number": 3,
          "variables": [],
          "files_accessed": [],
          "related_rules": [],
          "business_context": ""
        },
        {
          "rule_id": "RULE_0035",
          "rule_type": "data_access",
          "priority": 3,
          "description": "SQL db2insert: Table: TableRef(loc=SourceLocation(file='examples\\\\schema.sql', line=4, column=0), name='CUSTOMER', alias=None, schema=None)",
          "condition": "",
          "action": "Table: TableRef(loc=SourceLocation(file='examples\\\\schema.sql', line=4, column=0), name='CUSTOMER', alias=None, schema=None)",
          "source_file": "examples\\schema.sql",
          "line_number": 4,
          "variables": [],
          "files_accessed": [
            "TableRef(loc=SourceLocation(file='examples\\\\schema.sql', line=4, column=0), name='CUSTOMER', alias=None, schema=None)"
          ],
          "related_rules": [],
          "business_context": ""
        }
      ]
    },
    "examples\\display.dspf": {
      "metrics": {},
      "rules": []
    }
  },
  "cross_references": {
    "examples\\example.clle": [],
    "examples\\otmc10.clle": [],
    "examples\\example.rpgle": [],
    "examples\\example_rpg_fixed.rpg": [],
    "examples\\schema.sql": [],
    "examples\\display.dspf": []
  },
  "recommendations": [
    "No error handling rules found. Consider adding MONMSG commands.",
    "Low validation rule coverage. Consider adding input validation."
  ]
}